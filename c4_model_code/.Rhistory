## source functions
sourceDirectory('functions')
## packages
library(R.utils)
## source functions
sourceDirectory('functions')
calc_c4_photosynthesis = function(func = 'collatz',
tleaf = 25, ca = 400, par = 500,
q_yield = 0.066, abs = 0.8,
ca_frac = 0.8, func_ci = 'ca_frac',
tref_vcmax = 25, vcmax_ref = 39, func_vcmax_tresp = 'collatz',
tref_vpmax = 25, vpmax_ref = 0.78, func_vpmax_tresp = 'collatz'){
if(func == 'collatz'){
vcmax = calc_vcmax_tresp(tleaf = tleaf, tref = tref_vcmax, vcmax_ref = vcmax_ref, func = func_vcmax_tresp)
vpmax = calc_vpmax_tresp(tleaf = tleaf, tref = tref_vpmax, vpmax_ref = vpmax_ref, func = func_vpmax_tresp)
ci = ci_calc(ca = ca, ca_frac = ca_frac, func = func_ci)
ac = vcmax
aj = q_yield * abs * par
ap = vpmax * ci
a = pmin(ac, aj, ap)
return(data.frame(tleaf, ca, par,
q_yield, abs,
vcmax, vpmax, ci,
ac, aj, ap,
a))
} else{
return('invalid photosynthesis function specified')
}
}
calc_c4_photosynthesis()
?source
