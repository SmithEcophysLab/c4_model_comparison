### source code
source('../c4_model_code/calc_c4_photosynthesis.R')
calc_c4_photosynthesis()
sourceDirectory('../c4_model_code/functions')
calc_c4_photosynthesis()
### response curves
collatz_c4_co2_curve_lowlight = collatz_c4(ca = seq(10, 600, 10), par = 500, func = 'collatz')
### response curves
collatz_c4_co2_curve_lowlight = calc_c4_photosynthesis(ca = seq(10, 600, 10), par = 500, func = 'collatz')
collatz_c4_co2_curve_lowlight
collatz_c4_co2_curve_lowlight = calc_c4_photosynthesis(ca = seq(10, 600, 10), par = 500, func = 'collatz')
collatz_c4_co2_curve_highlight = calc_c4_photosynthesis(ca = seq(10, 600, 10), par = 1000, func = 'collatz')
collatz_c4_light_curve_lowco2 = calc_c4_photosynthesis(par = seq(10, 2000, 10), ca = 400, func = 'collatz')
collatz_c4_light_curve_highco2 = calc_c4_photosynthesis(par = seq(10, 2000, 10), ca = 1000, func = 'collatz')
collatz_c4_temperature_curve_lowlight = calc_c4_photosynthesis(tleaf = seq(1, 40, 1), par = 500, func = 'collatz')
collatz_c4_temperature_curve_highlight = calc_c4_photosynthesis(tleaf = seq(1, 40, 1), par = 1000, func = 'collatz')
### load libraries
library(tidyverse)
### make figures
#### CO2 response
collatz_c4_co2_plot_lowlight = ggplot(data = collatz_c4_co2_curve_lowlight,
aes(x = ca, y = a)) +
theme(legend.position = NULL,
axis.title.y=element_text(size=rel(2), colour = 'black'), # change y axis title properties
axis.title.x=element_text(size=rel(2), colour = 'black'), # change x axis title properties
axis.text.x=element_text(size=rel(2), colour = 'black'), # change x axis text properties
axis.text.y=element_text(size=rel(2), colour = 'black'), # change y axis text properties
panel.background = element_rect(fill = 'white', colour = 'black'), # change background panel colors
panel.grid.major = element_line(colour = "grey") # change backgrond color
) +
geom_line(size = 5, color = 'grey') +
geom_line(size = 4, color = 'orange', lty = 3, aes(y = aj)) +
geom_line(size = 4, color = 'blue', lty = 3, aes(y = ac)) +
geom_line(size = 4, color = 'darkgreen', lty = 3, aes(y = ap)) +
ylim(c(0, 60)) +
ylab(expression('Photosynthesis (µmol m' ^ '-2' * ' s' ^ '-1' *')')) +
xlab(expression('Atm. CO'[2] * ' (µmol mol' ^ '-1' * ')'))
collatz_c4_co2_plot_lowlight
collatz_c4_co2_plot_highlight = ggplot(data = collatz_c4_co2_curve_highlight,
aes(x = ca, y = a)) +
theme(legend.position = NULL,
axis.title.y=element_text(size=rel(2), colour = 'black'), # change y axis title properties
axis.title.x=element_text(size=rel(2), colour = 'black'), # change x axis title properties
axis.text.x=element_text(size=rel(2), colour = 'black'), # change x axis text properties
axis.text.y=element_text(size=rel(2), colour = 'black'), # change y axis text properties
panel.background = element_rect(fill = 'white', colour = 'black'), # change background panel colors
panel.grid.major = element_line(colour = "grey") # change backgrond color
) +
geom_line(size = 5, color = 'grey') +
geom_line(size = 4, color = 'orange', lty = 3, aes(y = aj)) +
geom_line(size = 4, color = 'blue', lty = 3, aes(y = ac)) +
geom_line(size = 4, color = 'darkgreen', lty = 3, aes(y = ap)) +
ylim(c(0, 60)) +
ylab(expression('Photosynthesis (µmol m' ^ '-2' * ' s' ^ '-1' *')')) +
xlab(expression('Atm. CO'[2] * ' (µmol mol' ^ '-1' * ')'))
collatz_c4_co2_plot_highlight
